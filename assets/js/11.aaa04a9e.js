(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{215:function(t,e,a){"use strict";a.r(e);var s=a(28),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"认识-annotations-特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#认识-annotations-特性"}},[t._v("#")]),t._v(" 认识 Annotations 特性")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#什么是-annotations"}},[t._v("什么是 Annotations?")])]),a("li",[a("a",{attrs:{href:"#在-python-mirai-中的应用"}},[t._v("在 python-mirai 中的应用")]),a("ul",[a("li",[a("a",{attrs:{href:"#基本案例"}},[t._v("基本案例")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"什么是-annotations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是-annotations"}},[t._v("#")]),t._v(" 什么是 Annotations?")]),t._v(" "),a("p",[t._v("即 Python 3.5 及以上版本的特性 类型注解(Annotations).\n于 "),a("a",{attrs:{href:"https://www.python.org/dev/peps/pep-3107/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PEP3107"),a("OutboundLink")],1),t._v(" 中被提出,\n并于 "),a("a",{attrs:{href:"https://www.python.org/dev/peps/pep-0526/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PEP526"),a("OutboundLink")],1),t._v(" 中强化,\n使之可以覆盖到变量层面.")]),t._v(" "),a("p",[t._v("主要的实现 "),a("code",[t._v("typing")]),t._v(" 是 Python 的标准库.")]),t._v(" "),a("h2",{attrs:{id:"在-python-mirai-中的应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-python-mirai-中的应用"}},[t._v("#")]),t._v(" 在 python-mirai 中的应用")]),t._v(" "),a("p",[t._v("我们使用 Annotations 特性来给事件运行主体分发上下文项, 并基于其提供了附加功能.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[a("code",[t._v("Application")]),t._v(" 机制也支持使用 "),a("code",[t._v("Annotations")]),t._v(" 特性, 且具体的变动将在接下来讲解.")])]),t._v(" "),a("h3",{attrs:{id:"基本案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本案例"}},[t._v("#")]),t._v(" 基本案例")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" mirai "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    Session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Member"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Friend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    GroupMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" FriendMessage\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GroupMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("GMHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Group"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" member"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Member"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" GroupMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("receiver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FriendMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("FMHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Session"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" friend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Friend"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" FriendMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("p",[t._v("当你做好类型推断后, 只需要按照规则调用就好.")]),t._v(" "),a("p",[t._v("可以作为注解项的类型(值), 以下都可以在模块 "),a("code",[t._v("mirai")]),t._v(" 处直接引入:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("是否常用")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("注解项的值")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("说明")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("指向的实例")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("条件限制")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("Mirai")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("即 "),a("code",[t._v("Mirai")]),t._v(" 实例本身")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("正在运行的 "),a("code",[t._v("Mirai")]),t._v(" 实例")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("无")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("Source")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("在信息链里面的 "),a("code",[t._v("Source")]),t._v("(消息源) 组件")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于取出消息的 "),a("code",[t._v("MessageID")]),t._v(" 和发送时间")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("不能在事件的监听里用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("MessageChain")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("捕获到的消息链")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于获取接收到的消息")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("不能在事件的监听里用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("Group")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("群消息的群")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于获取群消息的来源")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在监听 "),a("code",[t._v("GroupMessage")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("Member")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("发群消息的群成员")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于获取群消息的发送者")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在监听了 "),a("code",[t._v("GroupMessage")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("Friend")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("发好友消息的好友")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("用于获取好友消息的发送者")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在监听了 "),a("code",[t._v("FriendMessage")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("√")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("各个事件的类")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("事件的实例")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("事件的实例, 在 "),a("code",[t._v("mirai.event.external")]),t._v(" 内被定义")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在对应事件的监听内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("GroupMessage")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("属于低级API, 可以使用其他的代替")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前消息的序列化对象")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在监听 "),a("code",[t._v("GroupMessage")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("×")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("FriendMessage")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("属于低级API, 可以使用其他的代替")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前消息的序列化对象")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在监听 "),a("code",[t._v("FriendMessage")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("?")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v('"Sender"')])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("消息的发送者, 值可能是 "),a("code",[t._v("Member")]),t._v(" 也可能是 "),a("code",[t._v("Friend")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前消息的序列化对象内属性 "),a("code",[t._v("sender")]),t._v(" 的值")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("只能在实例内有属性 "),a("code",[t._v("sender")]),t._v(" 的事件内使用.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("?")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v('"Type"')])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("当前捕获到的事件名称")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("必定是字符串")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("魔法注解, 无条件限制")])])])])])}),[],!1,null,null,null);e.default=n.exports}}]);